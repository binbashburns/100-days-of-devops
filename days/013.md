# Day 013: IPtables Installation And Configuration

**Time**: 15 minutes

## Objective
We have one of our websites up and running on our Nautilus infrastructure in Stratos DC. Our security team has raised a concern that right now Apacheâ€™s port i.e 3003 is open for all since there is no firewall installed on these hosts. So we have decided to add some security layer for these hosts and after discussions and recommendations we have come up with the following requirements:

- Install iptables and all its dependencies on each app host.
- Block incoming port 3003 on all apps for everyone except for LBR host.
- Make sure the rules remain, even after system reboot.

## Technologies Used
- `ssh`
- `yum`
- `iptables`

## Steps

1. We'll need to do this for each host:
    ```bash
    # SSH to hosts
    ssh <user>@stapp[01|02|03]

    # Install IPTables
    sudo yum install iptables iptables-services -y

    # Insert a rule to accept traffic on port 3003, as long as its source is the load balancer
    sudo iptables -I INPUT 1 -p tcp --dport 3003 -s 172.16.238.14 -j ACCEPT

    # Reject traffic from everywhere but the load balancer
    sudo iptables -I INPUT 2 -p tcp --dport 3003 -j REJECT

    # Save the rules to be persisted after reboot
    sudo service iptables save
    ```

## Key Takeaways
- If you need to a repeat a task across multiple servers, ensure you make note of the methodology, so it can easily be replicated across other hosts. This will be valuable as task automation comes into play with Ansible.
