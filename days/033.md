# Day 033: Resolve Git Merge Conflicts

**Time**: 20 minutes

## Objective
Sarah and Max were working on writting some stories which they have pushed to the repository. Max has recently added some new changes and is trying to push them to the repository but he is facing some issues. Below you can find more details:

SSH into `storage server` using user `max` and password `Max_pass123`. Under `/home/max` you will find the `story-blog` repository. Try to push the changes to the origin repo and fix the issues. The `story-index.txt` must have titles for all 4 stories. Additionally, there is a typo in `The Lion and the Mooose` line where `Mooose` should be `Mouse`.

Click on the `Gitea UI` button on the top bar. You should be able to access the `Gitea` page. You can login to `Gitea` server from UI using username `sarah` and password `Sarah_pass123` or username `max` and password `Max_pass123`.

## Technologies Used
- `git`
- `ssh`
- `sed`

## Steps

1. SSH into the storage server, change into the repository working directory, confirm current branch and working tree status

    ```bash
    # SSH into the storage server as max
    thor@jumphost ~$ ssh max@ststor01

    # Change into the repository working directory
    max $ cd /home/max/story-blog

    # Confirm current branch and working tree status
    max (master)$ git status
    max (master)$ git branch
    ```

2. Fetch the latest remote changes, look at commit history, fix typo

    ```bash
    # Fetch the latest remote changes so local work can be replayed cleanly
    max (master)$ git fetch origin

    # Review recent commit history (local view)
    max (master)$ git log

    # Fix the typo in the story index (Mooose -> Mouse)
    max (master)$ sed -i ‘s/Mooose/Mouse/g’ story-index.txt
    ```

3. Verify file, stage and commit, rebase local commits

    ```bash
    # Verify the story index contains all four titles (and the typo is corrected)
    max (master)$ cat story-index.txt

    # Stage and commit the story-index fix
    max (master)$ git add story-index.txt
    max (master)$ git commit -m “Fix story index and Mouse typo”

    # Rebase local commits onto the updated remote master
    max (master)$ git rebase origin/master
    ```

4. Check rebase status, inspect it, resolve merge conflict

    ```bash
    # Check rebase state and see what’s staged vs conflicted
    max ((no branch, rebasing master))$ git status

    # Inspect the merge conflict markers in story-index.txt
    max ((no branch, rebasing master))$ sed -n ‘1,120p’ story-index.txt
    # <<<<<<< d5383b0a0c8fd0139d4c12c5a6fd0ea27f16379b
    # 1. The Lion and the Mouse
    # 2. The Frogs and the Ox
    # 3. The Fox and the Grapes
    # =======
    # 1. The Lion and the Mooose
    # 2. The Frogs and the Ox
    # 3. The Fox and the Grapes
    # 4. The Donkey and the Dog
    # >>>>>>> Added the fox and grapes story

    # Resolve the conflict by rewriting story-index.txt with the correct 4 lines
    max ((no branch, rebasing master))$ echo “1. The Lion and the Mouse” > story-index.txt
    max ((no branch, rebasing master))$ echo “2. The Frogs and the Ox” >> story-index.txt
    max ((no branch, rebasing master))$ echo “3. The Fox and the Grapes” >> story-index.txt
    max ((no branch, rebasing master))$ echo “4. The Donkey and the Dog” >> story-index.txt
    ```

5. Verify conflicts are resolved, git add / rebase, git push

    ```bash
    # Verify the resolved contents
    max ((no branch, rebasing master))$ cat story-index.txt

    # Mark the conflict as resolved and continue the rebase
    max ((no branch, rebasing master))$ git add story-index.txt
    max ((no branch, rebasing master))$ git rebase –continue

    # Confirm you’re back on master and clean
    max (master)$ git status

    # Push the updated master branch to origin
    max (master)$ git push origin master
    ```

## Key Takeaways
- be patient, sometimes resolution takes a while and you have to butt your head against a wall til you get to the right answer
