# Day 050: Set Resource Limits in Kubernetes Pods

**Time**: 5 minutes

## Objective
The Nautilus DevOps team has noticed performance issues in some Kubernetes-hosted applications due to resource constraints. To address this, they plan to set limits on resource utilization. Here are the details:

Create a pod named `httpd-pod` with a container named `httpd-container`. Use the `httpd` image with the `latest` tag (specify as `httpd:latest`). Set the following resource limits:

Requests: Memory: `15Mi`, CPU: `100m`

Limits: Memory: `20Mi`, CPU: `100m`

`Note`: The `kubectl` utility on `jump_host` is configured to operate with the Kubernetes cluster.

## Technologies Used
- `kubectl`
- `vi`
- `cat`


## Steps

1. First, review kubernetes docs for this at https://kubernetes.io/docs/concepts/configuration/manage-resources-containers/ 

    Once that's done, we'll start with a first draft for the yaml

    ```bash
    thor@jumphost ~$ kubectl run httpd-pod \
    --image=httpd:latest \
    --restart=Never \
    --dry-run=client \
    -o yaml > pod.yaml

    thor@jumphost ~$ cat pod.yaml 

    apiVersion: v1
    kind: Pod
    metadata:
      creationTimestamp: null
      labels:
        run: httpd-pod
      name: httpd-pod
    spec:
      containers:
      - image: httpd:latest
        name: httpd-pod
        resources: {}
      dnsPolicy: ClusterFirst
      restartPolicy: Never
    status: {}
    ```

2. Now we need to modify the container name, and resource allocation for this pod

    ```bash
    # use vi to modify the file
    thor@jumphost ~$ vi pod.yaml

    # cat it out, so you can see what I configured
    thor@jumphost ~$ cat pod.yaml 

    apiVersion: v1
    kind: Pod
    metadata:
      creationTimestamp: null
      labels:
        run: httpd-pod
      name: httpd-pod
    spec:
      containers:
      - image: httpd:latest
        name: httpd-container
        resources:
          requests:
            cpu: 100m
            memory: 15Mi
          limits:
            cpu: 100m
            memory: 20Mi
      dnsPolicy: ClusterFirst
      restartPolicy: Never
    status: {}
    ```

3. `kubectl apply` to make it real

    ```bash
    thor@jumphost ~$ k apply -f pod.yaml 
    
    pod/httpd-pod created
    ```

## Key Takeaways
- Check the `yaml` indentation. When I parsed it out it was wonky. If you need examples, look at k8s docs.
