# Day 048: Deploy Pods in Kubernetes Cluster

**Time**: 5 minutes

## Objective
The Nautilus DevOps team is diving into Kubernetes for application management. One team member has a task to create a pod according to the details below:

- Create a pod named `pod-httpd` using the `httpd` image with the `latest` tag. Ensure to specify the tag as `httpd:latest`.

- Set the `app` label to `httpd_app`, and name the container as `httpd-container`.

`Note`: The `kubectl` utility on `jump_host` is configured to operate with the Kubernetes cluster.

## Technologies Used
- `kubectl`
- `vi`

## Steps

1. Run `kubectl` with dry-run to get about 95% of the way there (can't imperatively name the container):

    ```bash
    thor@jumphost ~$ kubectl run pod-httpd \
    --image=httpd:latest \
    --labels=app=httpd_app \
    --restart=Never \
    --dry-run=client \
    -o yaml

    apiVersion: v1
    kind: Pod
    metadata:
    creationTimestamp: null
    labels:
        app: httpd_app
    name: pod-httpd
    spec:
    containers:
    - image: httpd:latest
        name: pod-httpd
        resources: {}
    dnsPolicy: ClusterFirst
    restartPolicy: Never
    status: {}
    ```

2. Now we use vi to create the manifest (this could've been achieved via redirect [>], but I totally forgot). 
**Note**: the container name has been changed from our previous output.

    ```bash
    thor@jumphost ~$ vi pod.yaml

    thor@jumphost ~$ cat pod.yaml

    apiVersion: v1
    kind: Pod
    metadata:
    creationTimestamp: null
    labels:
        app: httpd_app
    name: pod-httpd
    spec:
    containers:
    - image: httpd:latest
        name: httpd-container
        resources: {}
    dnsPolicy: ClusterFirst
    restartPolicy: Never
    status: {}
    ```

3. Apply and verify

    ```bash
    # Apply the manifest
    thor@jumphost ~$ kubectl apply -f pod.yaml
    pod/pod-httpd created

    # Verify it stood up correctly
    thor@jumphost ~$ kubectl get pod
    NAME        READY   STATUS    RESTARTS   AGE
    pod-httpd   1/1     Running   0          11s
    ```

## Key Takeaways
- Always lazy-generate with `--dry-run=client` if possible
- Don't forget to redirect output to save it to a file in one command to move quickly. Will be valuable in Kubernetes exams
